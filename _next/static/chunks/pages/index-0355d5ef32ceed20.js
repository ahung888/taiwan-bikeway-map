(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1536)}])},6009:function(n,e,t){"use strict";var i=t(5893),s=(t(7294),t(1163));function o(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}e.Z=function(n){var e=(0,s.useRouter)();return(0,i.jsx)("img",function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),i.forEach((function(e){o(n,e,t[e])}))}return n}({},n,{src:"".concat(e.basePath).concat(null===n||void 0===n?void 0:n.src)}))}},1536:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return V}});var i=t(5893),s=t(7294),o=t(5617),a=t(7510),c=t(5434),r=function(n){var e=n.name,t=n.showPanel,s=n.onClick,o=n.children;return(0,i.jsxs)("div",{className:"dropdown-group",children:[(0,i.jsxs)("div",{className:"btn btn-bullet",onClick:s,children:[e," ",(0,i.jsx)(c.FIC,{})]}),(0,i.jsx)("div",{className:"dropdown-panel",children:t?o:""})]})},l=[{name:"\u5317\u5317\u57fa\u5b9c",locations:["Taipei","NewTaipei","Keelung","YilanCounty"]},{name:"\u6843\u7af9\u82d7",locations:["Taoyuan","Hsinchu","HsinchuCounty","MiaoliCounty"]},{name:"\u4e2d\u5f70\u6295",locations:["Taichung","ChanghuaCounty","NantouCounty"]},{name:"\u96f2\u5609\u5357",locations:["YunlinCounty","Chiayi","ChiayiCounty","Tainan"]},{name:"\u9ad8\u5c4f",locations:["Kaohsiung","PingtungCounty"]},{name:"\u82b1\u6771",locations:["HualienCounty","TaitungCounty"]},{name:"\u6f8e\u91d1\u99ac",locations:["PenghuCounty","KinmenCounty","LienchiangCounty"]}],u={Taipei:"\u81fa\u5317\u5e02",NewTaipei:"\u65b0\u5317\u5e02",Taoyuan:"\u6843\u5712\u5e02",Taichung:"\u81fa\u4e2d\u5e02",Tainan:"\u81fa\u5357\u5e02",Kaohsiung:"\u9ad8\u96c4\u5e02",Keelung:"\u57fa\u9686\u5e02",Hsinchu:"\u65b0\u7af9\u5e02",HsinchuCounty:"\u65b0\u7af9\u7e23",MiaoliCounty:"\u82d7\u6817\u7e23",ChanghuaCounty:"\u5f70\u5316\u7e23",NantouCounty:"\u5357\u6295\u7e23",YunlinCounty:"\u96f2\u6797\u7e23",ChiayiCounty:"\u5609\u7fa9\u7e23",Chiayi:"\u5609\u7fa9\u5e02",PingtungCounty:"\u5c4f\u6771\u7e23",YilanCounty:"\u5b9c\u862d\u7e23",HualienCounty:"\u82b1\u84ee\u7e23",TaitungCounty:"\u81fa\u6771\u7e23",KinmenCounty:"\u91d1\u9580\u7e23",PenghuCounty:"\u6f8e\u6e56\u7e23",LienchiangCounty:"\u9023\u6c5f\u7e23"},d=function(n){var e=n.onSubmit,t=(0,s.useState)(null),o=t[0],a=t[1],c=(0,s.useState)(null),r=c[0],d=c[1],v=l.map((function(n,e){return(0,i.jsx)("div",{className:"btn ".concat(e===o?"active":""),onClick:function(){a(e),d(null)},children:n.name},e)})),h=(null!==o?l[o].locations:[]).map((function(n,e){return(0,i.jsx)("div",{className:"btn ".concat(n===r?"active":""),onClick:function(){return f(n)},children:u[n]},e)})),f=function(n){e(n),d(null),a(null)};return(0,i.jsxs)("div",{className:"city-select-panel",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"title",children:"\u5340\u57df"}),(0,i.jsx)("div",{className:"collection",children:v})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"title",children:"\u7e23\u5e02"}),(0,i.jsx)("div",{className:"collection",children:h})]})]})},v=t(4959),h=function(){var n=(0,o.I0)(),e=(0,s.useContext)(v.GS),t=(0,s.useState)(!1),c=t[0],l=t[1],h=(0,s.useState)("\u7e23\u5e02"),f=h[0],m=h[1],x=(0,o.v9)((0,a.CG)("type"));return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r,{name:f,showPanel:c,onClick:function(){return l(!c)},children:(0,i.jsx)(d,{onSubmit:function(t){return function(t){void 0!==u[t]&&(m(u[t]),l(!1),n((0,a.b2)()),n((0,a.C0)()),x===a.VO.BIKEWAY?(e.set(v.gQ.BIKEWAY,{city:t}),n(e.get()())):x===a.VO.STATION&&(e.set(v.gQ.BIKE_STATION,{city:t}),n(e.get()()),e.set(v.gQ.BIKE_AVAILABLE,{city:t}),n(e.get()())))}(t)}})})})},f=t(6893),m=t(9583),x=function(n){var e=n.onMenuClick,t=(0,o.I0)(),r=(0,s.useState)(!1),l=r[0],u=(r[1],(0,s.useState)(!1)),d=(u[0],u[1],(0,s.useState)("")),v=(d[0],d[1],(0,s.useRef)(null),(0,o.v9)((0,a.Si)("isMobile"))),x=(0,o.v9)((0,a.CG)("type")),j=a.G1.map((function(n,e){return(0,i.jsxs)("div",{className:"btn btn-bullet ".concat(x===n.type?"active":""),onClick:function(){return e=n.type,t((0,a.oz)(e)),t((0,a.b2)()),void t((0,a.C0)());var e},children:[n.type===a.VO.BIKEWAY?(0,i.jsx)(m.tbd,{}):(0,i.jsx)(c.MCF,{}),v?"":n.name]},e)}));"search-input ".concat(l?"active":"");return(0,i.jsxs)("div",{className:"header",children:[(0,i.jsx)("div",{className:"btn btn-bullet menu",onClick:e,children:(0,i.jsx)(f.cur,{})}),(0,i.jsxs)("div",{className:"quick-btns",children:[j,(0,i.jsx)(h,{})]})]})},j=t(8747),p=t(8340),y=function(n){var e=(0,o.I0)(),t=(0,o.v9)((0,p.JU)("selectedStationUID")),a=(0,o.v9)((0,p.JU)("showAvailableRent")),r=(0,s.useContext)(j.X$),l=n.geojson;return r.viewport.zoom>14?l.map((function(n,s){var o,r,l,u=a?null===n||void 0===n||null===(o=n.properties)||void 0===o?void 0:o.AvailableRentBikes:null===n||void 0===n||null===(r=n.properties)||void 0===r?void 0:r.AvailableReturnBikes,d=t===(null===n||void 0===n||null===(l=n.properties)||void 0===l?void 0:l.StationUID),v="marker ".concat(d?"active":""),h=d?80:60,f=a?"#f8b230":"#f36969",m=d?"14px":"10px",x=d?"translate(-87px, -86px)":"translate(-66px, -65px)";return(0,i.jsxs)(j.Jx,{className:v,longitude:n.geometry.coordinates[0],latitude:n.geometry.coordinates[1],children:[(0,i.jsxs)("svg",{height:h,viewBox:"0 0 24 24",style:{cursor:"pointer",fill:f,stroke:"none",transform:"translate(".concat(-h/2,"px,").concat(-h,"px)")},onClick:function(){return function(n){var t,i;(null===n||void 0===n||null===(t=n.properties)||void 0===t?void 0:t.StationUID)&&e((0,p.Bu)(null===n||void 0===n||null===(i=n.properties)||void 0===i?void 0:i.StationUID))}(n)},children:[(0,i.jsx)("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"}),(0,i.jsx)("circle",{cx:"12",cy:"10",r:"7",fill:"#fff"}),(0,i.jsx)("text",{x:"50%",y:"50%",style:{"font-size":"10px",fill:"#000",transform:"translate(-6px, 1px)"},children:u})]}),(0,i.jsx)(c.MCF,{style:{"font-size":m,color:"#fff",transform:x}})]},s)})):""},b=s.memo(y),g=[23.5042966,120.9583613],N={id:"clusters",type:"circle",source:"stations",filter:["has","point_count"],maxzoom:15,paint:{"circle-color":["step",["get","point_count"],"#51bbd6",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]}},C={id:"cluster-count",type:"symbol",source:"stations",filter:["has","point_count"],maxzoom:15,layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}},w={id:"bikeway",source:"bikeway",type:"line",paint:{"line-width":10,"line-color":"#007cbf"}},S=t(1567),k=t(2694);var O=14.5;function _(n){return n.substring(18,n.length-2).split(",").map((function(n){return n.split(" ").map((function(n){return Number(n)}))})).filter((function(n){return!isNaN(n[0])&&!isNaN(n[1])}))}function P(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),i.forEach((function(e){P(n,e,t[e])}))}return n}function T(n,e){if(null==n)return{};var t,i,s=function(n,e){if(null==n)return{};var t,i,s={},o=Object.keys(n);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(s[t]=n[t]);return s}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}var A=function(){var n=(0,s.useRef)(null),e=(0,s.useState)({latitude:g[0],longitude:g[1],zoom:7,bearing:0,pitch:0}),t=e[0],c=e[1],r=(0,o.v9)((0,a.Si)("isMobile")),l=(0,o.v9)((0,S.fQ)()),u=(0,o.v9)((0,p.JU)("stations")),d=r?-.015:0;(0,s.useEffect)((function(){var e=n.current.getMap();e.features;e.loadImage("http://localhost:3000/taiwan-bikeway-map/20210517-01.jpg",(function(n,t){if(n)throw n;e.addImage("cat",t)}))}),[n]),(0,s.useEffect)((function(){if(void 0!==("undefined"===typeof document?"undefined":(n=document)&&"undefined"!==typeof Symbol&&n.constructor===Symbol?"symbol":typeof n))return document.addEventListener("flytospot",v),function(){return document.removeEventListener("flytospot",v)};var n}),[]);var v=function(n){var e=n.position;if(void 0!==e){var i=e.long,s=void 0===i?0:i,o=e.lat,a=void 0===o?0:o;0!==s&&0!==a&&c({latitude:a,longitude:s+d,zoom:Math.max(t.zoom,O)})}}.bind(t),h=(0,k.Iy)(Object.values(u)),f={};if(l){console.log("selectedBikeway: ",l);var m=_(l.Geometry);console.log("coordinates: ",m),f={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:m}}]}}return(0,i.jsx)("div",{className:"map",children:(0,i.jsxs)(j.ZP,I({},t,{width:"100%",height:"100%",mapStyle:"mapbox://styles/mapbox/streets-v11",onViewportChange:function(n){return function(n){n.width,n.height;var e=T(n,["width","height"]);c(e)}(n)},mapboxApiAccessToken:"",ref:n,onClick:function(n){n.features[0]},children:[(0,i.jsx)(j.$j,{style:{right:7,bottom:135},positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,auto:!0}),(0,i.jsx)(j.Pv,{style:{right:7,bottom:40}}),(0,i.jsx)(b,{geojson:h}),(0,i.jsxs)(j.Hw,{id:"stations",type:"geojson",data:{features:h},cluster:!0,clusterMaxZoom:14,clusterRadius:50,children:[(0,i.jsx)(j.mh,I({},N)),(0,i.jsx)(j.mh,I({},C))]}),(0,i.jsx)(j.Hw,{id:"bikeway",type:"geojson",data:f,children:(0,i.jsx)(j.mh,I({},w))})]}))})},B=function(n){var e=new Event("flytospot");e.position=n,document.dispatchEvent(e)},E=function(n){var e=n.onClick,t=(0,o.I0)(),s=function(n){t((0,a.oz)(n)),e()};return(0,i.jsx)("div",{className:"homepage",children:(0,i.jsxs)("div",{className:"wrapper",children:[(0,i.jsx)("div",{className:"title",children:"\u81ea\u884c\u8eca\u9053\u5730\u5716\u8cc7\u8a0a"}),(0,i.jsxs)("div",{className:"nav-btns",children:[(0,i.jsxs)("div",{className:"btn btn-jumbo",onClick:function(){return s(a.VO.BIKEWAY)},children:[(0,i.jsx)(m.tbd,{}),(0,i.jsx)("div",{className:"desc",children:"\u81ea\u884c\u8eca\u9053"})]}),(0,i.jsxs)("div",{className:"btn btn-jumbo",onClick:function(){return s(a.VO.STATION)},children:[(0,i.jsx)(c.MCF,{}),(0,i.jsx)("div",{className:"desc",children:"\u81ea\u884c\u8eca\u7ad9"})]})]})]})})},R=t(1664),U=t(6009),M=function(n){var e=n.show,t=n.onNavClose;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"nav-panel navInfo ".concat(e?"active":""),children:[(0,i.jsxs)("header",{children:[(0,i.jsx)(c.MCF,{className:"logo",size:"5rem"}),(0,i.jsx)("h1",{children:"\u81ea\u884c\u8eca\u9053\u5730\u5716\u8cc7\u8a0a"})]}),(0,i.jsxs)("main",{children:[(0,i.jsx)("div",{children:"\u8cc7\u6599\u4ecb\u63a5\u300c\u4ea4\u901a\u90e8PTX\u5e73\u81fa\u300d"}),(0,i.jsx)("a",{href:"https://ptx.transportdata.tw/PTX/",target:"_blank",rel:"noopener noreferrer",children:(0,i.jsx)(U.Z,{src:"/images/PTX_logo.png",alt:"\u8cc7\u6599\u4ecb\u63a5\u300c\u4ea4\u901a\u90e8PTX\u5e73\u81fa\u300d"})})]}),(0,i.jsx)(R.default,{href:"/intro",children:"\u5730\u5716\u7c21\u4ecb"}),(0,i.jsx)("footer",{children:(0,i.jsxs)("div",{children:["ver: ","0.1.0"]})})]}),(0,i.jsx)("div",{className:"screen-mask ".concat(e?"active":""),onClick:t})]})},L=t(3750),K=function(n){var e=n.data,t=(0,o.I0)();return(0,i.jsxs)("div",{className:"card",onClick:function(){var n=_(e.Geometry);B({long:Number(n[0][0]),lat:Number(n[0][1])}),t((0,S.uW)(e.id))},children:[(0,i.jsx)("div",{className:"title",children:e.RouteName}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"desc",children:e.City}),(0,i.jsx)("div",{className:"desc",children:e.Town})]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{}),(0,i.jsx)("div",{className:"desc",children:e.AuthorityName})]}),(0,i.jsxs)("div",{className:"desc",children:[(0,i.jsx)(f.i63,{})," ",e.RoadSectionStart]}),(0,i.jsxs)("div",{className:"desc",children:[(0,i.jsx)(L.GKv,{})," ",e.RoadSectionEnd]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"desc",children:[(0,i.jsx)(m.tbd,{})," ",e.CyclingLength," \u516c\u5c3a"]}),(0,i.jsx)("div",{className:"desc",children:e.Direction})]})]})},z=t(8193),F=function(n){var e,t,s,a,c=n.data,r=(0,o.I0)(),l=(0,o.v9)((0,p.JU)("selectedStationUID")),u="card ".concat(l===c.StationUID?"active":"");return(0,i.jsxs)("div",{className:u,onClick:function(){var n,e,t,i;(null===c||void 0===c||null===(n=c.StationPosition)||void 0===n?void 0:n.PositionLon)&&(null===c||void 0===c||null===(e=c.StationPosition)||void 0===e?void 0:e.PositionLat)&&(B({long:null===c||void 0===c||null===(t=c.StationPosition)||void 0===t?void 0:t.PositionLon,lat:null===c||void 0===c||null===(i=c.StationPosition)||void 0===i?void 0:i.PositionLat}),r((0,p.Bu)(c.StationUID)))},children:[(0,i.jsx)("div",{className:"title",children:null===c||void 0===c||null===(e=c.StationName)||void 0===e?void 0:e.Zh_tw}),(0,i.jsx)("div",{className:"desc",children:null===c||void 0===c||null===(t=c.StationAddress)||void 0===t?void 0:t.Zh_tw}),(0,i.jsx)("div",{className:"desc",children:(a=null===c||void 0===c?void 0:c.ServiceStatus,0===a?"\u505c\u6b62\u71df\u904b":1===a?"\u6b63\u5e38\u71df\u904b":2===a?"\u66ab\u505c\u71df\u904b":"")}),(0,i.jsx)("div",{className:"desc",children:(s=null===c||void 0===c?void 0:c.ServiceType,1===s?"YouBike1.0":2===s?"YouBike2.0":"")}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"desc",children:[(0,i.jsx)(z.aBR,{})," \u53ef\u79df\u501f ",(0,i.jsxs)("span",{className:"rent",children:[null===c||void 0===c?void 0:c.AvailableRentBikes," \u8f1b"]})]}),(0,i.jsxs)("div",{className:"desc",children:[(0,i.jsx)(z.RFS,{})," \u53ef\u6b78\u9084 ",(0,i.jsxs)("span",{className:"return",children:[null===c||void 0===c?void 0:c.AvailableReturnBikes," \u8f1b"]})]})]})]})};var D=function(n){n=null!==n?n:function(n){throw n}(new TypeError("Cannot destructure undefined"));var e=(0,o.v9)((0,a.CG)("type")),t=(0,o.v9)((0,S.uJ)("entities")),s=(0,o.v9)((0,p.JU)("stations")),c="";return e===a.VO.BIKEWAY?c=Object.values(t).map((function(n,e){return(0,i.jsx)(K,{data:n},e)})):e===a.VO.STATION&&(c=Object.values(s).map((function(n,e){return(0,i.jsx)(F,{data:n},e)}))),(0,i.jsx)("div",{className:"item-list",children:c})},Y=t(9660),H=t.n(Y),J=function(){var n=(0,o.I0)(),e=(0,o.v9)((0,p.JU)("stationsCount")),t=(0,o.v9)((0,p.JU)("showAvailableRent")),s="station-status-switcher ".concat(e>0?"active":"");return(0,i.jsx)("div",{className:s,onClick:function(){n((0,p.P_)(!t))},children:(0,i.jsx)("div",{className:H().bg,children:(0,i.jsx)("div",{className:H().w,children:(0,i.jsx)("div",{className:"".concat(H().pinBall," ").concat(t?"":H().right),children:t?(0,i.jsxs)("div",{className:H().btnSwitch,children:[(0,i.jsx)(z.aBR,{}),a.U9.AvailableRent]}):(0,i.jsxs)("div",{className:H().btnSwitch,children:[(0,i.jsx)(z.RFS,{}),a.U9.AvailableReturn]})})})})})};function V(){var n=(0,s.useState)(!1),e=n[0],t=n[1],o=(0,s.useState)(!1),a=o[0],c=o[1];return(0,i.jsx)(i.Fragment,{children:e?(0,i.jsx)(E,{onClick:function(){return t(!1)}}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x,{onMenuClick:function(){return c(!0)}}),(0,i.jsx)(M,{show:a,onNavClose:function(){return c(!1)}}),(0,i.jsx)(D,{}),(0,i.jsx)(J,{}),(0,i.jsx)(A,{})]})})}},9660:function(n){n.exports={w:"station-status-switcher_w__lvRfL",bg:"station-status-switcher_bg___J5ik",btnSwitch:"station-status-switcher_btnSwitch__I8C0B",pinBall:"station-status-switcher_pinBall__HSj94",right:"station-status-switcher_right__cfWAE"}}},function(n){n.O(0,[228,445,13,617,634,207,774,888,179],(function(){return e=8581,n(n.s=e);var e}));var e=n.O();_N_E=e}]);